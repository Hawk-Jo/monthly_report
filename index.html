<!doctype html>
<html lang='ko'>
<head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <title>자산 관리 월간 리포트</title>
    <style>
/* PDF 최적화 스타일 - 호버 효과 제거 */
@page {
  size: A4;
  margin: 15mm 20mm;
  -webkit-print-color-adjust: exact;
  color-adjust: exact;
  @top-left { content: ""; }
  @top-center { content: ""; }
  @top-right { content: ""; }
  @bottom-left { content: ""; }
  @bottom-center { content: ""; }
  @bottom-right { content: ""; }
}

@media print {
  /* 브라우저 기본 헤더/푸터 제거 */
  @page { margin: 15mm 20mm; }
  html, body {
    -webkit-print-color-adjust: exact;
    color-adjust: exact;
    print-color-adjust: exact;
  }
  .section {
    page-break-inside: avoid;
    break-inside: avoid;
  }
  .chart-container {
    page-break-inside: avoid;
    break-inside: avoid;
  }
  .detail-table-wrapper {
    page-break-inside: avoid;
    break-inside: avoid;
  }
  /* 하드웨어와 에이전트 섹션을 같은 페이지에 유지 */
  .section.priority-low + .section.priority-high {
    page-break-before: avoid;
  }
}
:root {
  --bg-primary: #f8fafc;
  --bg-secondary: #ffffff;
  --bg-card: #f1f5f9;
  --text-primary: #1e293b;
  --text-secondary: #475569;
  --text-muted: #64748b;
  --accent-blue: #3b82f6;
  --accent-green: #10b981;
  --accent-yellow: #f59e0b;
  --accent-red: #ef4444;
  --border: #e2e8f0;
  --border-light: #f1f5f9;
}
* { box-sizing: border-box; }
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Malgun Gothic", "Noto Sans KR", Arial, "Helvetica Neue", Helvetica, sans-serif;
  color: var(--text-primary);
  margin: 0;
  padding: 0;
  background: var(--bg-primary);
  min-height: 100vh;
}
.report {
  width: 100%;
  max-width: 900px;
  margin: 0 auto;
  padding: 40px 24px;
}
.header {
  border-bottom: 1px solid var(--border);
  padding-bottom: 32px;
  margin-bottom: 48px;
  text-align: center;
}
.header h1 {
  margin: 0 0 12px 0;
  font-size: 36px;
  font-weight: 900;
  color: var(--text-primary);
  letter-spacing: -0.02em;
}
.header .meta {
  color: var(--text-muted);
  font-size: 18px;
  font-weight: 500;
}
.section {
  margin: 48px 0;
  page-break-inside: avoid;
  background: white;
  border-radius: 16px;
  padding: 32px;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
  border: 1px solid var(--border);
  position: relative;
}

.section h2 {
  font-size: 24px;
  margin: 0 0 24px 0;
  border-left: none;
  padding-left: 0;
  display: flex;
  align-items: center;
  gap: 12px;
  font-weight: 800;
  color: #1e293b;
}
.summary-box {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 24px;
  margin: 20px 0 32px 0;
}
.summary-title {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  margin: 0 0 16px 0;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.summary-content {
  display: flex;
  align-items: center;
  gap: 32px;
  flex-wrap: wrap;
}
.summary-metric {
  display: flex;
  align-items: center;
  gap: 12px;
}
.summary-number {
  font-size: 28px;
  font-weight: 800;
  color: var(--text-primary);
}
.summary-label {
  font-size: 14px;
  color: var(--text-muted);
  font-weight: 500;
}
.status-indicator {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  display: inline-block;
  margin-right: 4px;
}
.status-good { background-color: #16a34a; }
.status-warning { background-color: #d97706; }
.status-danger { background-color: #dc2626; }
.action-items {
  background: var(--bg-card);
  border: 1px solid var(--accent-yellow);
  border-radius: 8px;
  padding: 20px;
  margin: 24px 0;
  position: relative;
}
.action-items h3 {
  font-size: 16px;
  font-weight: 700;
  color: var(--accent-yellow);
  margin: 0 0 16px 0;
  display: flex;
  align-items: center;
  gap: 8px;
}
.action-items ul {
  margin: 0;
  padding-left: 0;
  list-style: none;
}
.action-items li {
  margin: 12px 0;
  position: relative;
  padding: 12px 16px 12px 32px;
  font-size: 14px;
  line-height: 1.5;
  background: var(--bg-secondary);
  border-radius: 6px;
  border-left: 3px solid var(--accent-yellow);
  color: var(--text-secondary);
}
.action-items li::before {
  content: "→";
  position: absolute;
  left: 12px;
  color: var(--accent-yellow);
  font-weight: bold;
}
.kv {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 12px;
  margin: 24px 0;
}

/* PDF-specific KV layout optimization */
@media print {
  .kv {
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
  }
  .kv .item {
    padding: 16px 12px;
  }
  .kv .item .label {
    font-size: 11px;
    margin-bottom: 6px;
  }
  .kv .item .value {
    font-size: 20px;
  }
}
.kv .item {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  padding: 20px;
  border-radius: 8px;
}
.kv .item .label {
  font-size: 12px;
  color: var(--text-muted);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 8px;
}
.kv .item .value {
  font-size: 24px;
  font-weight: 700;
  margin-top: 4px;
  color: var(--text-primary);
}
.kv .item .value small.change {
  display: block;
  font-size: 11px;
  font-weight: 400;
  margin-top: 4px;
  opacity: 0.8;
  color: var(--text-muted);
}
.change.positive { color: #16a34a; }
.change.negative { color: #dc2626; }
.change.neutral { color: #6b7280; }
.change.new { color: #2563eb; }
p { line-height: 1.5; margin: 8px 0; }
hr { border: none; border-top: 1px solid var(--line); margin: 16px 0; }
.badge {
  display: inline-block;
  font-size: 11px;
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid var(--line);
  margin-left: 6px;
}
.positive { color: #16a34a; }
.negative { color: #dc2626; }

/* PDF 최적화 차트 컨테이너 스타일 */
.chart-container {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 24px;
  margin: 24px 0;
  page-break-inside: avoid;
}

.chart-container h3 {
  font-size: 18px;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0 0 20px 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

.chart-wrapper {
  position: relative;
  height: 320px;
  width: 100%;
}

.chart-wrapper.small {
  height: 220px;
}

.chart-wrapper.horizontal {
  height: 250px;
  max-width: 100%;
  overflow: hidden;
}

/* 하드웨어 차트 좌우 레이아웃 */
.chart-with-table {
  display: flex;
  gap: 20px;
  align-items: flex-start;
}

.chart-section {
  flex: 1;
  min-width: 300px;
}

.table-section {
  flex: 1;
  min-width: 200px;
}

/* PDF용 차트 값 표시 테이블 */
.chart-values-table {
  margin-top: 0;
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}

.chart-values-table th,
.chart-values-table td {
  padding: 8px 12px;
  text-align: left;
  border-bottom: 1px solid var(--border-light);
}

.chart-values-table th {
  background: var(--bg-card);
  font-weight: 600;
  color: var(--text-secondary);
}

/* 상세 테이블 스타일 */
.detail-table-wrapper {
  margin: 24px 0;
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  background: var(--bg-secondary);
  page-break-inside: avoid;
}

.detail-table-wrapper h4 {
  font-size: 16px;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0 0 16px 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

.detail-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 14px;
  margin-top: 12px;
}

.detail-table thead th {
  background: var(--bg-card);
  border-bottom: 2px solid var(--border);
  text-align: left;
  padding: 12px 16px;
  font-weight: 600;
  color: var(--text-secondary);
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.detail-table tbody td {
  border-top: 1px solid var(--border-light);
  padding: 12px 16px;
  color: var(--text-primary);
  font-weight: 500;
}

.detail-table tbody tr:last-child td {
  border-bottom: none;
}

/* PDF용 요약 섹션 스타일 - 호버 효과 제거 */
.summary-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 20px;
  margin: 20px 0;
}

.summary-card {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  text-align: center;
}

.summary-card-title {
  font-size: 12px;
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.summary-card-value {
  font-size: 28px;
  font-weight: 900;
  margin-bottom: 4px;
  color: var(--text-primary);
}

.summary-card-subtitle {
  font-size: 12px;
  color: var(--text-secondary);
  font-weight: 500;
}

@media (max-width: 768px) {
  .summary-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
  }

  .summary-card {
    padding: 16px;
  }

  .summary-card-value {
    font-size: 24px;
  }
}
    </style>

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class='report'>
    <div class='header'>
        <h1>자산 관리 월간 리포트</h1>
        <div class='meta'>주식회사 셀파스 · 2025년 9월</div>
    </div>

    <!-- 전체 요약 섹션 -->
    <div class='section'>
        <h2>📊 주요 지표 요약</h2>
        <div class='summary-grid'>
            <div class='summary-card'>
                <div class='summary-card-title'>비용 절감 기회</div>
                <div class='summary-card-value'>1</div>
                <div class='summary-card-subtitle'>절감 방법 수</div>
            </div>
            <div class='summary-card'>
                <div class='summary-card-title'>하드웨어 관리</div>
                <div class='summary-card-value'>4</div>
                <div class='summary-card-subtitle'>관리 필요 장비</div>
            </div>
            <div class='summary-card'>
                <div class='summary-card-title'>에이전트 업데이트</div>
                <div class='summary-card-value'>15</div>
                <div class='summary-card-subtitle'>업데이트 필요</div>
            </div>
            <div class='summary-card'>
                <div class='summary-card-title'>온보딩 미완료</div>
                <div class='summary-card-value'>3</div>
                <div class='summary-card-subtitle'>미배정 계정</div>
            </div>
            <div class='summary-card'>
                <div class='summary-card-title'>오프보딩 미완료</div>
                <div class='summary-card-value'>1</div>
                <div class='summary-card-subtitle'>처리 필요 계정</div>
            </div>
        </div>
    </div>

    <!-- 소프트웨어 결제 금액 섹션 -->
    <div class='section priority-high'>
        <h2>소프트웨어 · 결제 금액</h2>
        
        <div class='summary-box'>
            <div class='summary-title'>이달의 핵심 지표</div>
            <div class='summary-content'>
                <div class='summary-metric'>
                    <span class='summary-number negative'>1,245,509원</span>
                    <span class='summary-label'>총 구독 비용</span>
                </div>
                <div class='summary-metric'>
                    <span class='status-indicator status-good'></span>
                    <span class='summary-label'>전월 대비 -63.3%</span>
                </div>
                <div class='summary-metric'>
                    <span class='summary-number'>1개</span>
                    <span class='summary-label'>비용 절감 가능 방법</span>
                </div>
            </div>
        </div>

        <div class='kv'>
            <div class='item'>
                <div class='label'>신규 소프트웨어 수</div>
                <div class='value'>5개</div>
            </div>
            <div class='item'>
                <div class='label'>신규 결제 합계</div>
                <div class='value'>196,814원</div>
            </div>
            <div class='item'>
                <div class='label'>최대 지출 소프트웨어</div>
                <div class='value'>GitHub<br><small class="change neutral">602,137원</small></div>
            </div>
        </div>

        <p>2025년 9월 소프트웨어 구독 비용은 1,245,509원입니다. 2025년 8월보다 2,147,652원 감소했습니다(-63.3%).</p>

        <h3>💰 결제 비용이 높은 소프트웨어 - 9월</h3>
        <p>결제 금액이 가장 많은 소프트웨어는 GitHub(602,137원)입니다.</p>

        <!-- PDF용 차트 1: 결제 비용이 높은 소프트웨어 TOP5 -->
        <div class="chart-container">
            <h3>📊 결제 비용이 높은 소프트웨어 TOP5 - 9월</h3>
            <div class="chart-wrapper horizontal">
                <canvas id="top5SoftwareChart"></canvas>
            </div>
            <!-- PDF용 차트 값 표시 테이블 -->
            <table class='chart-values-table'><thead><tr><th>소프트웨어</th><th>결제 금액</th></tr></thead><tbody><tr><td>Slack</td><td>2,093,726,888원</td></tr><tr><td>GitHub</td><td>1,432,514,064원</td></tr><tr><td>1Password</td><td>468,109,096원</td></tr><tr><td>Cursor</td><td>378,215,759원</td></tr><tr><td>ChatGPT</td><td>289,324,446원</td></tr></tbody></table>
        </div>

        <h3>🆕 신규 결제 소프트웨어 - 9월</h3>
        <p>8월에는 결제가 없었으나, 9월에는 신규로 5개의 소프트웨어가 결제되었으며 총 결제 금액은 196,814원입니다.</p>

        <div class="detail-table-wrapper">
            <h4>🆕 신규 결제 소프트웨어 목록</h4>
            
        <table class="detail-table">
            <thead>
                <tr>
                    <th>소프트웨어명</th>
                    <th>결제 금액</th>
                </tr>
            </thead>
            <tbody>
        
                <tr>
                    <td>Rize</td>
                    <td>96,410원</td>
                </tr>
            
                <tr>
                    <td>Retool</td>
                    <td>59,584원</td>
                </tr>
            
                <tr>
                    <td>Lovable</td>
                    <td>21,373원</td>
                </tr>
            
                <tr>
                    <td>Suno AI</td>
                    <td>17,052원</td>
                </tr>
            
                <tr>
                    <td>Firecrawl</td>
                    <td>2,395원</td>
                </tr>
            </tbody></table>
        </div>

        <h3>📈 결제 금액 급증 소프트웨어 - 9월</h3>
        <p>전월 대비 50% 이상 결제 금액이 급증한 소프트웨어는 0개 있습니다.</p>

        <div class="detail-table-wrapper">
            <h4>📈 전월 대비 50% 이상 급증 소프트웨어 목록</h4>
            <p style="text-align: center; padding: 20px; color: #64748b; font-style: italic;">데이터가 없습니다.</p>
        </div>

        <h3>💡 비용 절감 방법 - 9월</h3>
        <p>6개월 연속으로 월간 결제를 한 소프트웨어가 3개 있습니다. 오래 사용할 소프트웨어를 연간 결제로 전환하면 평균 20% 절감 효과를 볼 수 있습니다.</p>
        <p>9월에 결제된 유사 소프트웨어 카테고리는 0개이며, 총 0개의 유사 소프트웨어가 결제되었습니다.</p>

        <div class="detail-table-wrapper">
            <h4>📊 장기 월간 결제 소프트웨어 목록</h4>
            
        <table class="detail-table">
            <thead>
                <tr>
                    <th>소프트웨어명</th>
                    <th>최대 월 결제액</th>
                    <th>평균 월 결제액</th>
                </tr>
            </thead>
            <tbody>
        
                <tr>
                    <td>GITBOOK</td>
                    <td>32,924원</td>
                    <td>22,568원</td>
                </tr>
            
                <tr>
                    <td>Linkedin</td>
                    <td>1,038,153원</td>
                    <td>169,123원</td>
                </tr>
            
                <tr>
                    <td>Sentry</td>
                    <td>56,671원</td>
                    <td>42,441원</td>
                </tr>
            </tbody></table>
        </div>

        <div class="detail-table-wrapper">
            <h4>🔄 유사 기능 소프트웨어 카테고리</h4>
            <p style="text-align: center; padding: 20px; color: #64748b; font-style: italic;">데이터가 없습니다.</p>
        </div>
        
    </div>

    <!-- 소프트웨어 이용 시간 섹션 -->
    <div class='section priority-medium'>
        <h2>소프트웨어 · 이용 시간</h2>
        
        <div class='summary-box'>
            <div class='summary-title'>이달의 핵심 지표</div>
            <div class='summary-content'>
                <div class='summary-metric'>
                    <span class='summary-number'>14개</span>
                    <span class='summary-label'>미활성 소프트웨어</span>
                </div>
                <div class='summary-metric'>
                    <span class='status-indicator status-warning'></span>
                    <span class='summary-label'>검토 필요</span>
                </div>
            </div>
        </div>

        <div class='action-items'><h3>⚠️ 조치 필요 항목</h3><ul><li>10분 미만 사용 소프트웨어 14개 → 사용 현황 검토 및 구독 해지 고려</li></ul></div>

        <p>미활성 소프트웨어는 한 달동안 총 이용시간이 10분 미만인 소프트웨어입니다.<br>2025년 9월의 미활성 소프트웨어는 14개입니다.</p>
        
    </div>

    <!-- 하드웨어 섹션 -->
    <div class='section priority-low'>
        <h2>하드웨어</h2>
        <div class='summary-box'>
            <div class='summary-title'>하드웨어 관리 현황</div>
            <div class='summary-content'>
                <div class='summary-metric'>
                    <span class='summary-number'>38개</span>
                    <span class='summary-label'>총 보유</span>
                </div>
                <div class='summary-metric'>
                    <span class='status-indicator status-warning'></span>
                    <span class='summary-label'>관리 필요 4개</span>
                </div>
            </div>
        </div>

        <p>2025년 9월 총 하드웨어 수는 38개 입니다. 관리가 필요한 하드웨어는 4개입니다.</p>

        <!-- PDF용 차트 2: 관리 필요 하드웨어 상태 분포 -->
        <div class='chart-container'><h3>🔧 관리 필요 하드웨어 상태 분포</h3><div class='chart-with-table'><div class='chart-section'><div class='chart-wrapper small'><canvas id='hardwareStatusChart'></canvas></div></div><div class='table-section'><table class='chart-values-table'><thead><tr><th>상태</th><th>개수</th></tr></thead><tbody><tr><td>고장</td><td>3개</td></tr><tr><td>폐기 예정</td><td>1개</td></tr></tbody></table></div></div></div>
    </div>

    <!-- 에이전트 섹션 -->
    <div class='section priority-high'>
        <h2>에이전트</h2>
        
        <div class='summary-box'>
            <div class='summary-title'>에이전트 관리 현황</div>
            <div class='summary-content'>
                <div class='summary-metric'>
                    <span class='summary-number'>19개</span>
                    <span class='summary-label'>총 운영</span>
                </div>
                <div class='summary-metric'>
                    <span class='status-indicator status-danger'></span>
                    <span class='summary-label'>업데이트 필요 15개</span>
                </div>
            </div>
        </div>

        <div class='action-items'><h3>🔄 조치 필요 항목</h3><ul><li>에이전트 15개 업데이트 → 정확한 이용시간 측정을 위한 필수 작업</li></ul></div>

        <div class='kv'>
            <div class='item'>
                <div class='label'>총 에이전트 수</div>
                <div class='value'>19개<br><small class="change positive">8월: 18개 (+5.6%)</small></div>
            </div>
            <div class='item'>
                <div class='label'>업데이트 필요 에이전트</div>
                <div class='value'>15개<br><span class='badge'>조치 필요</span></div>
            </div>
        </div>

        <p>보다 정확한 이용시간 측정을 위해 15개의 에이전트에 업데이트가 필요합니다. (상세 목록은 부록을 참고하세요.)</p>
        <p>현재 총 19개의 에이전트가 운영 중입니다.</p>
        

    </div>

    <!-- 온보딩 섹션 -->
    <div class='section priority-high'>
        <h2>온보딩</h2>

        <div class='summary-box'>
            <div class='summary-title'>신규 직원 온보딩 현황</div>
            <div class='summary-content'>
                <div class='summary-metric'>
                    <span class='summary-number'>7개</span>
                    <span class='summary-label'>신규 계정</span>
                </div>
                <div class='summary-metric'>
                    <span class='status-indicator status-danger'></span>
                    <span class='summary-label'>미완료 3개 (42.9%)</span>
                </div>
            </div>
        </div>

        <div class='action-items'><h3>👤 조치 필요 항목</h3><ul><li>미배정 계정 3개 → 하드웨어/소프트웨어 배정 및 온보딩 완료</li></ul></div>

        <div class='kv'>
            <div class='item'>
                <div class='label'>신규 계정</div>
                <div class='value'>7개</div>
            </div>
            <div class='item'>
                <div class='label'>미배정 계정</div>
                <div class='value'>3개<br><span class='badge'>확인 필요</span></div>
            </div>
            <div class='item'>
                <div class='label'>온보딩 완료율</div>
                <div class='value negative'>57.1%</div>
            </div>
        </div>

        <p>2025년 9월 신규 등록 계정 총 7개 중 하드웨어 또는 소프트웨어가 등록되지 않은 계정이 3개 있습니다.<br>해당 계정의 배정을 확인해주세요. (상세 목록은 부록을 참고하세요.)</p>

    </div>

    <!-- 오프보딩 섹션 -->
    <div class='section priority-low'>
        <h2>오프보딩</h2>

        <div class='summary-box'>
            <div class='summary-title'>퇴사자 오프보딩 현황</div>
            <div class='summary-content'>
                <div class='summary-metric'>
                    <span class='summary-number'>1개</span>
                    <span class='summary-label'>해지 계정</span>
                </div>
                <div class='summary-metric'>
                    <span class='status-indicator status-danger'></span>
                    <span class='summary-label'>미완료 1개 (0.0%)</span>
                </div>
            </div>
        </div>

        <div class='action-items'><h3>🔄 조치 필요 항목</h3><ul><li>배정 잔여 계정 1개 → 하드웨어/소프트웨어 배정 해제 완료</li><li>연동 불일치 계정 2개 → 계정 확인 후 SMPLY에서 제외</li></ul></div>

        <div class='kv'>
            <div class='item'>
                <div class='label'>해지 계정</div>
                <div class='value'>1개</div>
            </div>
            <div class='item'>
                <div class='label'>미완료 계정</div>
                <div class='value'>1개<br><span class='badge'>정리 필요</span></div>
            </div>
            <div class='item'>
                <div class='label'>연동 불일치 계정</div>
                <div class='value negative'>2개<br><span class='badge'>정리 필요</span></div>
            </div>
            <div class='item'>
                <div class='label'>오프보딩 완료율</div>
                <div class='value negative'>0.0%</div>
            </div>
        </div>

        <p>2025년 9월 해지 계정 총 1개 중 하드웨어/소프트웨어 배정이 남아있는 계정이 1개 있습니다.<br>구글/MS 연동 해지되어 퇴사한 것으로 예상되는 계정이 2개 있습니다. 배정되어있던 자산과 소프트웨어를 회수하고, SMPLY에서 제외해주세요. (부록에 상세 목록이 있습니다.)</p>

    </div>

    <!-- 필터 사용 가이드 이미지 -->
    <div style='text-align: center; margin: 32px 0; padding: 20px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px;'>
        <h4 style='margin-bottom: 16px; color: #374151; font-size: 16px;'>💡 구성원 리스트 필터 사용 방법</h4>
        <img src='filter_example.PNG' alt='구성원 리스트 필터 사용 예시'>
        <p style='margin-top: 12px; color: #6b7280; font-size: 14px; line-height: 1.4;'>위 이미지와 같이 구성원 이름을 복사하여 필터에 붙여넣으면 해당 구성원을 쉽게 찾을 수 있습니다.</p>
    </div>

    <!-- 부록 섹션 -->
    <div class='section priority-low' style='page-break-before: always;'>
        <h2>📋 부록</h2>
        <p style='color: #64748b; font-size: 14px; margin-bottom: 32px;'>상세 계정 및 에이전트 목록</p>

        <!-- 업데이트 필요 에이전트 목록 -->
        <div class='detail-table-wrapper'><h4>🔄 업데이트 필요 에이전트 목록</h4>
        <table class="detail-table">
            <thead>
                <tr>
                    <th>에이전트ID</th>
                    <th>소유자 이름</th>
                    <th>소유자 팀</th>
                    <th>현재 버전</th>
                    <th>마지막 접속</th>
                </tr>
            </thead>
            <tbody>
        
                <tr>
                    <td>S9P90Y3Y</td>
                    <td>조성학</td>
                    <td>프로덕트,데이터</td>
                    <td>0.3.0</td>
                    <td>2025-09-10</td>
                </tr>
            
                <tr>
                    <td>XDDATSBK</td>
                    <td>이지훈</td>
                    <td>오퍼레이션</td>
                    <td>0.3.0</td>
                    <td>2025-09-23</td>
                </tr>
            
                <tr>
                    <td>P6RQPKRZ</td>
                    <td>정웅기</td>
                    <td>개발,프로덕트</td>
                    <td>0.0.0</td>
                    <td>2025-09-18</td>
                </tr>
            
                <tr>
                    <td>YSKENBZJ</td>
                    <td>정웅기</td>
                    <td>개발,프로덕트</td>
                    <td>0.0.0</td>
                    <td>2025-09-22</td>
                </tr>
            
                <tr>
                    <td>NC79S43R</td>
                    <td>정웅기</td>
                    <td>개발,프로덕트</td>
                    <td>0.3.0</td>
                    <td>2025-09-25</td>
                </tr>
            
                <tr>
                    <td>B0HJDD5M</td>
                    <td>김상현</td>
                    <td>개발,프로덕트</td>
                    <td>0.3.0</td>
                    <td>2025-09-26</td>
                </tr>
            
                <tr>
                    <td>GY7BHKNZ</td>
                    <td>위성훈</td>
                    <td>개발,프로덕트</td>
                    <td>0.3.0</td>
                    <td>2025-09-25</td>
                </tr>
            
                <tr>
                    <td>NNAT1SXZ</td>
                    <td>나종협</td>
                    <td>개발,프로덕트</td>
                    <td>0.3.0</td>
                    <td>2025-09-26</td>
                </tr>
            
                <tr>
                    <td>JR1QMWTE</td>
                    <td>김태희</td>
                    <td>개발,프로덕트</td>
                    <td>0.3.0</td>
                    <td>2025-09-26</td>
                </tr>
            
                <tr>
                    <td>ZCC5W92H</td>
                    <td>김용진</td>
                    <td>오퍼레이션,마케팅</td>
                    <td>0.3.0</td>
                    <td>2025-09-17</td>
                </tr>
            
                <tr>
                    <td>52GG3BZB</td>
                    <td>이재열</td>
                    <td>오퍼레이션</td>
                    <td>0.3.0</td>
                    <td>2025-09-26</td>
                </tr>
            
                <tr>
                    <td>WBDWQYYF</td>
                    <td>권정인</td>
                    <td>개발,프로덕트</td>
                    <td>0.3.0</td>
                    <td>2025-09-26</td>
                </tr>
            
                <tr>
                    <td>XWXSN4G8</td>
                    <td>권정인</td>
                    <td>개발,프로덕트</td>
                    <td>0.3.0</td>
                    <td>2025-09-26</td>
                </tr>
            
                <tr>
                    <td>N/A</td>
                    <td>권정인</td>
                    <td>개발,프로덕트</td>
                    <td>0.0.0</td>
                    <td>2025-09-23</td>
                </tr>
            
                <tr>
                    <td>D49XWSXY</td>
                    <td>조성학</td>
                    <td>프로덕트,데이터</td>
                    <td>0.3.0</td>
                    <td>2025-09-26</td>
                </tr>
            </tbody></table></div>

        <!-- 미배정 신규 계정 목록 -->
        <div class='detail-table-wrapper'><h4>👤 미배정 신규 계정 목록 <small style='font-size: 12px; color: var(--text-muted); font-weight: 400; margin-left: 8px;'>💡 복사해서 이름 필터로 사용하세요!</small></h4><p style="line-height: 1.6; color: var(--text-primary); font-size: 14px;">전민규, 테스트, 김칠</p></div>

        <!-- 오프보딩 미완료 계정 목록 -->
        <div class='detail-table-wrapper'><h4>🔄 오프보딩 미완료 계정 목록 <small style='font-size: 12px; color: var(--text-muted); font-weight: 400; margin-left: 8px;'>💡 복사해서 이름 필터로 사용하세요!</small></h4><p style="line-height: 1.6; color: var(--text-primary); font-size: 14px;">셀파스 엔지니어링</p></div>

        <!-- 연동 불일치 계정 목록 -->
        <div class='detail-table-wrapper'><h4>🔗 연동 불일치 계정 목록 <small style='font-size: 12px; color: var(--text-muted); font-weight: 400; margin-left: 8px;'>💡 복사해서 이름 필터로 사용하세요!</small></h4><p style="line-height: 1.6; color: var(--text-primary); font-size: 14px;">위성훈, 김칠</p></div>

        
    </div>

    <div class='footer'>
        <div style='display: flex; justify-content: space-between; align-items: center; padding: 20px 0; border-top: 1px solid var(--border); margin-top: 40px;'>
            <div style='font-weight: 700; color: var(--text-primary); font-size: 16px;'>
                SMPLY 자산관리 월간 리포트
            </div>
            <div style='color: var(--text-muted); font-size: 14px;'>
                2025년 9월 | 주식회사 셀파스
            </div>
        </div>
    </div>
</div>

<script>
// PDF 최적화 차트 데이터 (값 표시, 툴팁 제거)
const chartData = {
  "top5_software": {
    "labels": ["Slack", "GitHub", "1Password", "Cursor", "ChatGPT"],
    "data": [2093726888.0, 1432514063.5, 468109096.4, 378215759.2, 289324446.3]
  },
  "hardware_status": {
    "labels": ["\uace0\uc7a5", "\ud3d0\uae30 \uc608\uc815"],
    "data": [3, 1],
    "backgroundColor": ["#FF6384", "#36A2EB"]
  }
};

// PDF 최적화 차트 초기화 함수 (데이터 라벨 표시, 툴팁 비활성화)
function initializePdfCharts() {
  // 차트 1: 결제 비용이 높은 소프트웨어 TOP5 (수평 막대그래프) - PDF 최적화
  const ctx1 = document.getElementById('top5SoftwareChart');
  if (ctx1) {
    if (!chartData.top5_software.labels || chartData.top5_software.labels.length === 0) {
      ctx1.getContext('2d').font = '16px Arial';
      ctx1.getContext('2d').textAlign = 'center';
      ctx1.getContext('2d').fillStyle = '#6b7280';
      ctx1.getContext('2d').fillText('등록된 내용이 없습니다', ctx1.width / 2, ctx1.height / 2);
      return;
    }

    new Chart(ctx1, {
      type: 'bar',
      data: {
        labels: chartData.top5_software.labels,
        datasets: [{
          label: '결제 금액 (원)',
          data: chartData.top5_software.data,
          backgroundColor: '#3b82f6',
          borderColor: '#1e40af',
          borderWidth: 1,
          borderRadius: 4
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        indexAxis: 'y',
        layout: {
          padding: {
            left: 10,
            right: 50,
            top: 10,
            bottom: 10
          }
        },
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            enabled: false  // PDF용 툴팁 비활성화
          },
          datalabels: {
            display: true,
            anchor: 'end',
            align: 'right',
            formatter: function(value) {
              return (value / 1000).toLocaleString() + 'K원';
            },
            color: '#1e293b',
            font: {
              weight: 'bold',
              size: 10
            }
          }
        },
        scales: {
          x: {
            beginAtZero: true,
            ticks: {
              callback: function(value) {
                return (value / 1000).toLocaleString() + 'K원';
              }
            },
            grid: {
              color: '#f1f5f9'
            }
          },
          y: {
            grid: {
              display: false
            }
          }
        }
      }
    });
  }

  // 차트 2: 하드웨어 상태 분포 (도넛차트) - PDF 최적화
  const ctx3 = document.getElementById('hardwareStatusChart');
  if (ctx3) {
    if (!chartData.hardware_status.labels || chartData.hardware_status.labels.length === 0) {
      const chartContainer = ctx3.closest('.chart-container');
      if (chartContainer) {
        chartContainer.style.display = 'none';
      }
      return;
    }

    new Chart(ctx3, {
      type: 'doughnut',
      data: {
        labels: chartData.hardware_status.labels,
        datasets: [{
          data: chartData.hardware_status.data,
          backgroundColor: chartData.hardware_status.backgroundColor,
          borderWidth: 2,
          borderColor: '#ffffff',
          hoverBorderWidth: 3
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '60%',
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              padding: 20,
              usePointStyle: true
            }
          },
          tooltip: {
            enabled: false  // PDF용 툴팁 비활성화
          },
          datalabels: {
            display: true,
            formatter: function(value, context) {
              return value + '개';
            },
            color: '#ffffff',
            font: {
              weight: 'bold',
              size: 12
            }
          }
        }
      }
    });
  }
}

// PDF용 데이터 라벨 플러그인 로드 및 페이지 로드 시 차트 초기화
window.addEventListener('load', function() {
  // Chart.js datalabels 플러그인이 있다면 등록
  if (typeof ChartDataLabels !== 'undefined') {
    Chart.register(ChartDataLabels);
  }
  initializePdfCharts();
});
</script>

</body>
</html>
